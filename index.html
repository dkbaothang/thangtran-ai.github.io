<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>üé§ TH·∫ÆNG TR·∫¶N KARAOKE AI</title>
    <style>
        body { background: #000; color: #fff; font-family: 'Segoe UI', Arial; text-align: center; padding: 20px; margin: 0; }
        .control-panel { background: #111; padding: 20px; border-bottom: 3px solid #ff0000; position: sticky; top: 0; z-index: 100; }
        .search-container { display: flex; max-width: 800px; margin: 0 auto; gap: 10px; }
        input { flex: 1; padding: 15px; border-radius: 30px; border: 2px solid #444; background: #222; color: #fff; font-size: 16px; outline: none; }
        button { padding: 10px 25px; border-radius: 30px; border: none; cursor: pointer; font-weight: bold; font-size: 16px; transition: 0.3s; }
        .btn-mic { background: #444; color: #fff; }
        .btn-mic.active { background: #ff0000; box-shadow: 0 0 15px #ff0000; }
        .btn-play { background: #ff0000; color: #fff; }
        #player-box { margin: 20px auto; max-width: 900px; border-radius: 20px; overflow: hidden; box-shadow: 0 0 40px rgba(255,0,0,0.3); }
        #status { color: #888; font-size: 14px; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="control-panel">
        <h1>üé§ TH·∫ÆNG TR·∫¶N KARAOKE AI</h1>
        <div class="search-container">
            <input type="text" id="inputField" placeholder="N√≥i ho·∫∑c nh·∫≠p b√†i h√°t...">
            <button id="micBtn" class="btn-mic">üé§</button>
            <button class="btn-play" onclick="executeSearch()">H√ÅT</button>
        </div>
        <div id="status">S·∫µn s√†ng ph·ª•c v·ª• S·∫øp Th·∫Øng Tr·∫ßn!</div>
    </div>
    <div id="player-box"><div id="player"></div></div>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
        const API_KEY = 'AIzaSyCaZnEK1Ds7i3hGIIomN2gLs961nCXW91M'; // Kh√≥a m·ªõi c·ªßa S·∫øp
        var player;

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '600', width: '100%', videoId: 'vs_Ji3xfkzI',
                playerVars: { 'autoplay': 1, 'origin': window.location.origin, 'enablejsapi': 1 }
            });
        }

        async function executeSearch() {
            var input = document.getElementById('inputField').value;
            if (!input) return;
            document.getElementById('status').innerText = "AI ƒëang t√¨m b√†i h√°t cho S·∫øp...";
            const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=1&q=${encodeURIComponent(input)}&type=video&key=${API_KEY}`;
            try {
                const response = await fetch(url);
                const data = await response.json();
                if (data.items && data.items.length > 0) {
                    player.loadVideoById(data.items[0].id.videoId);
                    document.getElementById('status').innerText = "ƒê√£ t√¨m th·∫•y: " + data.items[0].snippet.title;
                } else {
                    document.getElementById('status').innerText = "Kh√¥ng t√¨m th·∫•y b√†i h√°t.";
                }
            } catch (e) { document.getElementById('status').innerText = "L·ªói k·∫øt n·ªëi."; }
        }

        const micBtn = document.getElementById('micBtn');
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'vi-VN';
        micBtn.onclick = () => { recognition.start(); micBtn.classList.add('active'); };
        recognition.onresult = (event) => {
            document.getElementById('inputField').value = event.results[0][0].transcript;
            executeSearch();
        };
        recognition.onend = () => { micBtn.classList.remove('active'); };

        // CH·∫∂N THO√ÅT LY SANG YOUTUBE
        document.addEventListener('click', function(e) {
            let link = e.target.closest('a');
            if (link && link.href.includes('youtube.com/watch')) {
                e.preventDefault();
                let videoId = new URL(link.href).searchParams.get('v');
                if (videoId) { player.loadVideoById(videoId); window.scrollTo(0,0); }
            }
        });
    </script>
</body>
</html>
