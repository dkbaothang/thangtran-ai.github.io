<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Th·∫Øng Tr·∫ßn AI - Karaoke Pro System</title>
    <style>
        body { background: #000; color: #fff; font-family: 'Segoe UI', Arial; text-align: center; padding: 20px; margin: 0; }
        .control-panel { background: #111; padding: 20px; border-bottom: 3px solid #ff0000; position: sticky; top: 0; z-index: 100; }
        .search-container { display: flex; max-width: 800px; margin: 0 auto; gap: 10px; }
        input { flex: 1; padding: 15px; border-radius: 30px; border: 2px solid #444; background: #222; color: #fff; font-size: 18px; }
        input:focus { border-color: #ff0000; outline: none; }
        button { padding: 10px 25px; border-radius: 30px; border: none; cursor: pointer; font-weight: bold; font-size: 16px; transition: 0.3s; }
        .btn-mic { background: #333; color: white; font-size: 24px; }
        .btn-mic.active { background: #ff0000; box-shadow: 0 0 15px #ff0000; }
        .btn-play { background: #ff0000; color: white; }
        #player-box { margin-top: 30px; border: 4px solid #ff0000; border-radius: 20px; overflow: hidden; box-shadow: 0 0 40px rgba(255,0,0,0.3); max-width: 1100px; margin-left: auto; margin-right: auto; }
        .status-text { color: #888; font-size: 14px; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="control-panel">
        <h1>üé§ TH·∫ÆNG TR·∫¶N AI KARAOKE GLOBAL</h1>
        <div class="search-container">
            <input type="text" id="inputField" placeholder="N√≥i ho·∫∑c nh·∫≠p t√™n b√†i h√°t / D√°n link YouTube...">
            <button id="micBtn" class="btn-mic">üé§</button>
            <button class="btn-play" onclick="executeSearch()">H√ÅT</button>
        </div>
        <div id="status" class="status-text">S·∫µn s√†ng ph·ª•c v·ª• S·∫øp Th·∫Øng Tr·∫ßn!</div>
    </div>

    <div id="player-box"><div id="player"></div></div>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
   const API_KEY = 'AIzaSyBChYUV6QDpytk9YjkBpuoarmc824ONOAE';
        var player;
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '600', width: '100%', videoId: 'vs_Ji3xfkzI', // B√†i m·∫∑c ƒë·ªãnh: Nh·ªõ Qu√™ X∆∞a
                playerVars: { 'autoplay': 1, 'rel': 0, 'origin': window.location.origin, 'enablejsapi': 1 }
            });
        }

        // X·ª¨ L√ù NH·∫¨P VƒÇN B·∫¢N (ENTER ƒê·ªÇ H√ÅT)
        document.getElementById('inputField').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') { executeSearch(); }
        });

        function executeSearch() {
            var input = document.getElementById('inputField').value;
            if (!input) return;
            var vid = extractVideoId(input);
            if (vid) { 
                player.loadVideoById(vid); 
                document.getElementById('status').innerText = "ƒêang ph√°t video ID: " + vid;
            } else {
                // N·∫øu kh√¥ng ph·∫£i link, ta c√≥ th·ªÉ d√πng t·ª´ kh√≥a ƒë·ªÉ t√¨m qua API (Ph·∫ßn n√†y c·∫ßn API Key n√¢ng cao)
                document.getElementById('status').innerText = "Vui l√≤ng d√°n ID ho·∫∑c Link chu·∫©n ƒë·ªÉ tr√°nh l·ªói 153";
            }
        }

        function extractVideoId(url) {
            var regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            var match = url.match(regExp);
            return (match && match[2].length == 11) ? match[2] : url;
        }

        // X·ª¨ L√ù GI·ªåNG N√ìI SI√äU NH·∫†Y
        const micBtn = document.getElementById('micBtn');
        const inputField = document.getElementById('inputField');
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

        if (SpeechRecognition) {
            const recognition = new SpeechRecognition();
            recognition.lang = 'vi-VN';
            recognition.interimResults = true; // HI·ªÜN CH·ªÆ NGAY KHI ƒêANG N√ìI (TƒÇNG ƒê·ªò NH·∫†Y)

            micBtn.onclick = () => {
                recognition.start();
                micBtn.classList.add('active');
                document.getElementById('status').innerText = "AI ƒëang l·∫Øng nghe S·∫øp...";
            };

            recognition.onresult = (event) => {
                const transcript = Array.from(event.results)
                    .map(result => result[0])
                    .map(result => result.transcript)
                    .join('');
                inputField.value = transcript; // ƒê·ªï ch·ªØ v√†o thanh t√¨m ki·∫øm
            };

            recognition.onend = () => {
                micBtn.classList.remove('active');
                document.getElementById('status').innerText = "ƒê√£ nh·∫≠n l·ªánh! Nh·∫•n H√ÅT ƒë·ªÉ b·∫Øt ƒë·∫ßu.";
            };
        } else {
            alert("Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ AI gi·ªçng n√≥i. S·∫øp h√£y d√πng Chrome!");
        }
    </script>
</body>

</html>

