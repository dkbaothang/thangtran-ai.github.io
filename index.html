<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>üé§ TH·∫ÆNG TR·∫¶N KARAOKE /title>
  <style>
    body {
      margin: 0;
      font-family: Arial;
      background: #050510;
      color: white;
    }

    header {
      text-align: center;
      padding: 20px;
      font-size: 28px;
      font-weight: bold;
      color: #00ffee;
      text-shadow: 0 0 15px #00ffee;
    }

    .container {
      display: grid;
      grid-template-columns: 2fr 1fr;
      height: 90vh;
    }

    /* LEFT PANEL */
    .left {
      padding: 20px;
      border-right: 2px solid rgba(0,255,255,0.2);
    }

    .search-box {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    input {
      flex: 1;
      padding: 15px;
      border-radius: 30px;
      border: none;
      font-size: 16px;
      outline: none;
    }

    button {
      padding: 15px 20px;
      border-radius: 30px;
      border: none;
      cursor: pointer;
      font-weight: bold;
      background: #00ffee;
      color: black;
      box-shadow: 0 0 15px #00ffee;
    }

    button:hover {
      background: #00ccff;
    }

    .results {
      display: flex;
      flex-direction: column;
      gap: 15px;
      overflow-y: auto;
      max-height: 70vh;
    }

    .video-item {
      display: flex;
      gap: 15px;
      padding: 10px;
      border-radius: 15px;
      background: rgba(255,255,255,0.05);
      cursor: pointer;
      transition: 0.2s;
    }

    .video-item:hover {
      background: rgba(0,255,255,0.15);
    }

    .video-item img {
      width: 160px;
      border-radius: 12px;
    }

    .video-title {
      font-size: 18px;
      font-weight: bold;
      color: #00ffee;
    }

    /* RIGHT PANEL */
    .right {
      padding: 20px;
    }

    .panel-title {
      font-size: 20px;
      margin-bottom: 10px;
      color: #ff00ff;
      text-shadow: 0 0 10px #ff00ff;
    }

    .playlist {
      background: rgba(255,255,255,0.05);
      padding: 10px;
      border-radius: 15px;
      min-height: 200px;
      margin-bottom: 20px;
    }

    .playlist-item {
      padding: 8px;
      cursor: pointer;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .lyrics {
      background: rgba(255,255,255,0.05);
      padding: 15px;
      border-radius: 15px;
      min-height: 250px;
      font-size: 16px;
      line-height: 1.6;
    }
  </style>
</head>

<body>

<header>üé§ TH·∫ÆNG TR·∫¶N KARAOKE AI ‚Äî Kekara Pro</header>

<div class="container">

  <!-- LEFT -->
  <div class="left">
    <div class="search-box">
      <input id="query" placeholder="Nh·∫≠p t√™n b√†i karaoke...">
      <button onclick="search()">üîç</button>
      <button onclick="voiceSearch()">üéôÔ∏è</button>
    </div>

    <div class="results" id="results"></div>
  </div>

  <!-- RIGHT -->
  <div class="right">
    <div class="panel-title">üìå Playlist</div>
    <div class="playlist" id="playlist"></div>

    <div class="panel-title">üé∂ Lyrics (Auto Karaoke)</div>
    <div class="lyrics" id="lyrics">
      Ch·ªçn m·ªôt b√†i ƒë·ªÉ hi·ªÉn th·ªã lyrics text tr∆∞·ªõc...
    </div>
  </div>

</div>

<script>
  const WORKER_URL = "https://thang-tran-karaoke-ai.thangtran.workers.dev/search?q=";
  let playlist = [];

  async function search() {
    const q = document.getElementById("query").value;
    const resBox = document.getElementById("results");
    resBox.innerHTML = "‚è≥ ƒêang t√¨m...";

    const res = await fetch(WORKER_URL + encodeURIComponent(q));
    const data = await res.json();

    resBox.innerHTML = "";

    data.items.forEach(item => {
      const videoId = item.id.videoId;
      const title = item.snippet.title;
      const thumb = item.snippet.thumbnails.medium.url;

      const div = document.createElement("div");
      div.className = "video-item";

      div.innerHTML = `
        <img src="${thumb}">
        <div>
          <div class="video-title">${title}</div>
          <button onclick="addPlaylist('${videoId}','${title}')">‚ûï Playlist</button>
        </div>
      `;

      resBox.appendChild(div);
    });
  }

  function addPlaylist(id, title) {
    playlist.push({id,title});
    renderPlaylist();
  }

  function renderPlaylist() {
    const box = document.getElementById("playlist");
    box.innerHTML = "";

    playlist.forEach(v => {
      const div = document.createElement("div");
      div.className = "playlist-item";
      div.innerText = "üéµ " + v.title;
      div.onclick = () => showLyrics(v.title);
      box.appendChild(div);
    });
  }

  function showLyrics(title) {
    document.getElementById("lyrics").innerHTML =
      "üé§ Lyrics demo cho b√†i:<br><br><b>" + title + "</b><br><br>(Text tr∆∞·ªõc ‚Äî Sync sau...)";
  }

  /* üéôÔ∏è Voice Search */
  function voiceSearch() {
    const SpeechRecognition =
      window.SpeechRecognition || window.webkitSpeechRecognition;

    if (!SpeechRecognition) {
      alert("Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ Voice Search!");
      return;
    }

    const recog = new SpeechRecognition();
    recog.lang = "vi-VN";

    recog.onresult = function(e) {
      const text = e.results[0][0].transcript;
      document.getElementById("query").value = text;
      search();
    };

    recog.start();
  }
</script>

</body>
</html>
