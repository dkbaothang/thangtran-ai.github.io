<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üé§ TH·∫ÆNG TR·∫¶N KARAOKE AI ‚Äî Pro</title>

  <style>
    body {
      margin: 0;
      font-family: Arial;
      background: #0d0d0f;
      color: white;
    }

    header {
      padding: 20px;
      text-align: center;
      font-size: 26px;
      font-weight: bold;
      background: #111;
      border-bottom: 2px solid red;
    }

    .container {
      display: grid;
      grid-template-columns: 2fr 1fr;
      height: 100vh;
    }

    /* LEFT SIDE */
    .main {
      padding: 20px;
    }

    .search-box {
      display: flex;
      gap: 10px;
    }

    input {
      flex: 1;
      padding: 14px;
      border-radius: 12px;
      border: none;
      font-size: 16px;
    }

    button {
      padding: 14px 20px;
      border: none;
      border-radius: 12px;
      background: red;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }

    iframe {
      width: 100%;
      height: 420px;
      margin-top: 20px;
      border-radius: 16px;
      border: none;
    }

    /* Lyrics Panel */
    .lyrics {
      margin-top: 20px;
      padding: 15px;
      background: #1a1a1f;
      border-radius: 14px;
      min-height: 120px;
    }

    .lyrics h3 {
      margin: 0;
      color: pink;
    }

    /* RIGHT SIDE Playlist */
    .playlist {
      border-left: 2px solid #222;
      padding: 20px;
      background: #111;
    }

    .playlist h2 {
      margin-top: 0;
      color: red;
    }

    .song {
      padding: 12px;
      margin-bottom: 10px;
      background: #1c1c22;
      border-radius: 12px;
      cursor: pointer;
    }

    .song:hover {
      background: #2a2a33;
    }

    .status {
      margin-top: 10px;
      color: pink;
    }
  </style>
</head>

<body>

<header>üé§ TH·∫ÆNG TR·∫¶N KARAOKE AI ‚Äî Kekara Pro</header>

<div class="container">

  <!-- LEFT MAIN -->
  <div class="main">
    <div class="search-box">
      <input id="q" placeholder="Nh·∫≠p b√†i h√°t karaoke... VD: S∆°n T√πng"/>
      <button onclick="searchSong()">H√ÅT</button>
    </div>

    <p class="status" id="status"></p>

    <!-- Player -->
    <div id="player"></div>

    <!-- Lyrics -->
    <div class="lyrics">
      <h3>üìú Lyrics Panel</h3>
      <p id="lyricsText">Ch·ªçn b√†i h√°t ƒë·ªÉ hi·ªÉn th·ªã l·ªùi...</p>
    </div>
  </div>

  <!-- RIGHT PLAYLIST -->
  <div class="playlist">
    <h2>üé∂ Playlist Queue</h2>
    <div id="playlist"></div>
  </div>

</div>

<script>
  const WORKER =
    "https://thang-tran-karaoke-ai.thangtran.workers.dev/search?q=";

  let queue = [];

  async function searchSong() {
    const keyword = document.getElementById("q").value.trim();
    const status = document.getElementById("status");

    if (!keyword) return;

    status.innerText = "‚è≥ ƒêang t√¨m karaoke...";

    const res = await fetch(WORKER + encodeURIComponent(keyword));
    const data = await res.json();

    queue = data.items.map(item => ({
      id: item.id.videoId,
      title: item.snippet.title
    }));

    renderPlaylist();
    status.innerText = "‚úÖ Ch·ªçn b√†i ƒë·ªÉ ph√°t!";
  }

  function renderPlaylist() {
    const div = document.getElementById("playlist");
    div.innerHTML = "";

    queue.forEach(song => {
      const el = document.createElement("div");
      el.className = "song";
      el.innerText = "üéµ " + song.title;
      el.onclick = () => playSong(song);
      div.appendChild(el);
    });
  }

  function playSong(song) {
    document.getElementById("player").innerHTML = `
      <iframe
        src="https://www.youtube.com/embed/${song.id}"
        allowfullscreen>
      </iframe>
    `;

    // Lyrics demo text
    document.getElementById("lyricsText").innerText =
      "üé§ Lyrics cho: " + song.title +
      "\n\n(Phase 2: s·∫Ω t·ª± ƒë·ªông load lyric th·∫≠t)";
  }
</script>

</body>
</html>
